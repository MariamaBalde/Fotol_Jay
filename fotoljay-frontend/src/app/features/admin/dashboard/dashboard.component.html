<app-admin-header></app-admin-header>

<div class="admin-dashboard">
  <div class="dashboard-header">
    <h1>ğŸ–¥ï¸ Panel Administrateur</h1>
    <p class="subtitle">Tableau de bord FOTOLJAY</p>
    <button class="refresh-btn" (click)="refresh()" [disabled]="loading">
      <i class="fas fa-sync-alt"></i> Actualiser
    </button>
  </div>

  <!-- Ã‰tat de chargement -->
  <div class="loading-state" *ngIf="loading">
    <div class="loading-spinner"></div>
    <p>Chargement des statistiques...</p>
  </div>

  <!-- Ã‰tat d'erreur -->
  <div class="error-state" *ngIf="error && !loading">
    <div class="error-icon">âš ï¸</div>
    <h3>Erreur de chargement</h3>
    <p>{{ error }}</p>
    <button class="btn-primary" (click)="refresh()">RÃ©essayer</button>
  </div>

  <!-- Contenu principal -->
  <div class="dashboard-content" *ngIf="!loading && !error && stats">

    <!-- Alertes -->
    <div class="alerts-section" *ngIf="alerts.length > 0">
      <h2>ğŸš¨ Alertes</h2>
      <div class="alerts-list">
        <div
          class="alert-item"
          [ngClass]="alert.type"
          *ngFor="let alert of alerts"
        >
          <div class="alert-content">
            <h4>{{ alert.title }}</h4>
            <p>{{ alert.message }}</p>
          </div>
          <div class="alert-actions">
            <button
              *ngIf="alert.actionUrl"
              class="btn-small"
              (click)="navigateTo(alert.actionUrl)"
            >
              Voir
            </button>
            <button
              class="btn-small dismiss"
              (click)="dismissAlert(alert.id)"
              title="Fermer"
            >
              <i class="fas fa-times"></i>
            </button>
          </div>
        </div>
      </div>
    </div>

    <!-- Statistiques principales -->
    <div class="stats-grid">
      <div class="stat-card">
        <div class="stat-icon">ğŸ‘¥</div>
        <div class="stat-content">
          <div class="stat-number">{{ stats.totalUsers | number }}</div>
          <div class="stat-label">Utilisateurs totaux</div>
          <div class="stat-sub" *ngIf="stats.activeUsers">
            {{ stats.activeUsers | number }} actifs
          </div>
        </div>
      </div>

      <div class="stat-card">
        <div class="stat-icon">ğŸ“¦</div>
        <div class="stat-content">
          <div class="stat-number">{{ stats.totalProducts | number }}</div>
          <div class="stat-label">Produits totaux</div>
          <div class="stat-sub">
            {{ stats.approvedProducts | number }} approuvÃ©s
          </div>
        </div>
      </div>

      <div class="stat-card warning">
        <div class="stat-icon">â³</div>
        <div class="stat-content">
          <div class="stat-number">{{ stats.pendingProducts | number }}</div>
          <div class="stat-label">En attente</div>
          <div class="stat-sub">ModÃ©ration requise</div>
        </div>
      </div>

      <div class="stat-card success">
        <div class="stat-icon">âœ…</div>
        <div class="stat-content">
          <div class="stat-number">{{ stats.moderationRate | number:'1.1-1' }}%</div>
          <div class="stat-label">Taux modÃ©ration</div>
          <div class="stat-sub">Produits approuvÃ©s</div>
        </div>
      </div>

      <div class="stat-card vip" *ngIf="stats.vipRevenue">
        <div class="stat-icon">â­</div>
        <div class="stat-content">
          <div class="stat-number">{{ stats.vipRevenue | number }} FCFA</div>
          <div class="stat-label">Revenus VIP</div>
          <div class="stat-sub" *ngIf="stats.vipSubscribers">
            {{ stats.vipSubscribers | number }} abonnÃ©s
          </div>
        </div>
      </div>

      <div class="stat-card info" *ngIf="stats.newUsersToday">
        <div class="stat-icon">ğŸ†•</div>
        <div class="stat-content">
          <div class="stat-number">{{ stats.newUsersToday | number }}</div>
          <div class="stat-label">Nouveaux aujourd'hui</div>
          <div class="stat-sub" *ngIf="stats.newUsersThisWeek">
            {{ stats.newUsersThisWeek | number }} cette semaine
          </div>
        </div>
      </div>

      <div class="stat-card conversion" *ngIf="stats.conversionRate !== undefined">
        <div class="stat-icon">ğŸ“ˆ</div>
        <div class="stat-content">
          <div class="stat-number">{{ stats.conversionRate | number:'1.1-1' }}%</div>
          <div class="stat-label">Taux de conversion</div>
          <div class="stat-sub">Contacts Ã©tablis</div>
        </div>
      </div>

      <div class="stat-card warning" *ngIf="stats.pendingReports">
        <div class="stat-icon">ğŸš¨</div>
        <div class="stat-content">
          <div class="stat-number">{{ stats.pendingReports | number }}</div>
          <div class="stat-label">Signalements</div>
          <div class="stat-sub">En attente</div>
        </div>
      </div>

      <div class="stat-card error" *ngIf="stats.recentErrors">
        <div class="stat-icon">âš ï¸</div>
        <div class="stat-content">
          <div class="stat-number">{{ stats.recentErrors | number }}</div>
          <div class="stat-label">Erreurs systÃ¨me</div>
          <div class="stat-sub">DerniÃ¨res 24h</div>
        </div>
      </div>

      <div class="stat-card performance" *ngIf="stats.uptime">
        <div class="stat-icon">âš¡</div>
        <div class="stat-content">
          <div class="stat-number">{{ stats.uptime | number:'1.1-1' }}%</div>
          <div class="stat-label">DisponibilitÃ©</div>
          <div class="stat-sub" *ngIf="stats.avgResponseTime">
            {{ stats.avgResponseTime | number }}ms rÃ©ponse
          </div>
        </div>
      </div>
    </div>

    <!-- Actions rapides -->
    <div class="quick-actions">
      <h2>ğŸ”§ Actions Rapides</h2>
      <div class="actions-grid">
        <div class="action-card" (click)="navigateTo('/admin/moderation')">
          <div class="action-icon">ğŸ”</div>
          <div class="action-content">
            <h3>ModÃ©ration</h3>
            <p>GÃ©rer les produits en attente</p>
          </div>
        </div>

        <div class="action-card" (click)="navigateTo('/admin/users')">
          <div class="action-icon">ğŸ‘¥</div>
          <div class="action-content">
            <h3>Utilisateurs</h3>
            <p>GÃ©rer les comptes utilisateur</p>
          </div>
        </div>

        <div class="action-card" (click)="navigateTo('/admin/reports')">
          <div class="action-icon">ğŸš¨</div>
          <div class="action-content">
            <h3>Signalements</h3>
            <p>GÃ©rer les signalements utilisateurs</p>
          </div>
        </div>

        <div class="action-card" (click)="navigateTo('/admin/moderators')">
          <div class="action-icon">ğŸ›¡ï¸</div>
          <div class="action-content">
            <h3>ModÃ©rateurs</h3>
            <p>GÃ©rer les modÃ©rateurs</p>
          </div>
        </div>

        <div class="action-card" (click)="navigateTo('/admin/vip-settings')">
          <div class="action-icon">â­</div>
          <div class="action-content">
            <h3>VIP</h3>
            <p>ParamÃ¨tres abonnement VIP</p>
          </div>
        </div>

        <div class="action-card" (click)="exportReports()">
          <div class="action-icon">ğŸ“Š</div>
          <div class="action-content">
            <h3>Exporter</h3>
            <p>Rapports et statistiques</p>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>