<div class="mes-produits-container">
  <!-- Navigation -->
  <app-navbar></app-navbar>

  <!-- Hero Section pour Mes Produits -->
  <section class="dashboard-hero">
    <div class="hero-overlay">
      <div class="hero-content">
        <h1 class="hero-title">üì¶ Mon Espace Vendeur</h1>
        <p class="hero-subtitle">G√©rez vos annonces et suivez vos performances</p>

        <!-- Actions rapides -->
        <div class="quick-actions">
          <button class="action-btn primary" (click)="naviguerVersCreation()">
            <span class="btn-icon"><i class="fas fa-plus text-white"></i></span>
            Nouvelle annonce
          </button>
          <!-- <button class="action-btn secondary" (click)="rafraichir()" [disabled]="chargement">
            Actualiser
          </button> -->
                      <span class="btn-icon"><i class="fas fa-sync-alt text-blue-600"></i></span>

        </div>
      </div>
    </div>
  </section>

 <!-- Statistiques Dashboard -->
 <section class="stats-section" *ngIf="!chargement">
   <div class="stats-container">
     <div class="stat-card total" [ngClass]="{'animate-in': !chargement}">
       <div class="stat-icon"><i class="fas fa-chart-bar text-white"></i></div>
       <div class="stat-content">
         <div class="stat-number">{{ totalProduits }}</div>
         <div class="stat-label">Total annonces</div>
       </div>
     </div>

     <div class="stat-card active" [ngClass]="{'animate-in': !chargement}">
       <div class="stat-icon"><i class="fas fa-check-circle text-white"></i></div>
       <div class="stat-content">
         <div class="stat-number">{{ produitsActifs }}</div>
         <div class="stat-label">Annonces actives</div>
       </div>
     </div>

     <div class="stat-card pending" [ngClass]="{'animate-in': !chargement}">
       <div class="stat-icon"><i class="fas fa-clock text-white"></i></div>
       <div class="stat-content">
         <div class="stat-number">{{ produitsEnAttente }}</div>
         <div class="stat-label">En mod√©ration</div>
       </div>
     </div>

     <div class="stat-card expired" [ngClass]="{'animate-in': !chargement}">
       <div class="stat-icon"><i class="fas fa-hourglass-end text-white"></i></div>
       <div class="stat-content">
         <div class="stat-number">{{ produitsExpires }}</div>
         <div class="stat-label">Expir√©es</div>
       </div>
     </div>
   </div>
 </section>

    <!-- √âtat de chargement -->
    <div class="loading-state" *ngIf="chargement">
      <div class="loading-spinner"></div>
      <p>Chargement de vos annonces...</p>
    </div>

    <!-- √âtat d'erreur -->
    <div class="error-state" *ngIf="erreur && !chargement">
      <div class="error-icon">‚ö†Ô∏è</div>
      <h3>Erreur de chargement</h3>
      <p>{{ erreur }}</p>
      <button class="btn-primary" (click)="rafraichir()">R√©essayer</button>
    </div>

    <!-- √âtat vide -->
    <div class="empty-state" *ngIf="!chargement && !erreur && totalProduits === 0">
      <div class="empty-icon">üì≠</div>
      <h3>Aucune annonce</h3>
      <p>Vous n'avez pas encore publi√© d'annonce sur FreshMarket.</p>
      <button class="btn-primary" (click)="naviguerVersCreation()">
        Cr√©er ma premi√®re annonce
      </button>
    </div>

 <!-- Liste des produits -->
 <main class="products-section" *ngIf="!chargement && !erreur && totalProduits > 0">
   <!-- Filtres et tri -->
   <div class="products-header">
     <div class="products-info">
       <h2 class="section-title">Mes Annonces</h2>
       <p class="section-subtitle">{{ totalProduits }} annonce(s) au total</p>
     </div>
     <div class="products-controls">
       <select class="filter-select" (change)="filtrerParStatut($event)">
         <option value="tous">Tous les statuts</option>
         <option value="APPROUVE">Actives</option>
         <option value="EN_ATTENTE">En attente</option>
         <option value="REFUSE">Refus√©es</option>
         <option value="EXPIRE">Expir√©es</option>
       </select>
     </div>
   </div>

   <!-- Grille des produits -->
   <div class="products-grid">
     <div
       class="product-card"
       *ngFor="let produit of (produits$ | async)?.produits"
       [ngClass]="{'animate-in': !chargement}"
     >
       <!-- Image principale -->
       <div class="product-image">
         <img
           *ngIf="produit.images && produit.images.length > 0"
           [src]="obtenirUrlImage(produit.images[0].url)"
           [alt]="produit.titre"
           (error)="handleImageError($event)"
         />
         <div class="no-image" *ngIf="!produit.images || produit.images.length === 0">
           <span class="no-image-icon"><i class="fas fa-camera text-gray-400"></i></span>
           <span class="no-image-text">Pas d'image</span>
         </div>

         <!-- Badges -->
         <div class="product-badges">
           <div class="vip-badge" *ngIf="produit.utilisateur.finVip">
             <span class="badge-icon"><i class="fas fa-star text-yellow-400"></i></span>
             <span class="badge-text">VIP</span>
           </div>
           <div class="status-badge" [ngClass]="obtenirCouleurStatut(produit.statut)">
             <span class="status-icon"><i [class]="obtenirIconeStatut(produit.statut) + ' text-white'"></i></span>
             <span class="status-text">{{ obtenirStatutLibelle(produit.statut) }}</span>
           </div>
         </div>
       </div>

       <!-- Contenu -->
       <div class="product-content">
         <div class="product-header">
           <h3 class="product-title">{{ produit.titre }}</h3>
           <div class="product-price">
             <span class="price-amount">{{ produit.prix | number: '1.0-0' }}</span>
             <span class="price-currency">FCFA</span>
           </div>
         </div>

         <div class="product-meta">
           <div class="meta-item">
             <span class="meta-icon"><i class="fas fa-eye text-gray-500"></i></span>
             <span class="meta-text">{{ produit.vues }} vues</span>
           </div>
           <div class="meta-item">
             <span class="meta-icon"><i class="fas fa-map-marker-alt text-gray-500"></i></span>
             <span class="meta-text">{{ produit.utilisateur.localisation || 'Non sp√©cifi√©' }}</span>
           </div>
           <div class="meta-item" *ngIf="produit.statut === 'APPROUVE'">
             <span class="meta-icon"><i class="fas fa-clock text-gray-500"></i></span>
             <span class="meta-text">{{ calculerJoursRestants(produit) }}j restants</span>
           </div>
         </div>

         <!-- Barre d'expiration -->
         <div class="expiration-progress" *ngIf="produit.statut === 'APPROUVE'">
           <div class="expiration-bar">
             <div
               class="expiration-fill"
               [style.width.%]="calculerProgressionExpiration(produit)"
             ></div>
           </div>
         </div>
       </div>

       <!-- Actions -->
       <div class="product-actions">
         <button
           (click)="modifierProduit(produit)"
           title="Modifier l'annonce"
         >
           <span class="btn-icon"><i class="fas fa-edit text-blue-600"></i></span>
         </button>

         <button
           class="action-btn republish"
           *ngIf="peutRepublier(produit)"
           (click)="republierProduit(produit)"
           title="Republier l'annonce"
         >
           <span class="btn-icon"><i class="fas fa-redo text-orange-600"></i></span>
           <span class="btn-text">Republier</span>
         </button>

         <button
           (click)="supprimerProduit(produit)"
           title="Supprimer l'annonce"
         >
           <span class="btn-icon"><i class="fas fa-trash text-red-600"></i></span>
         </button>
       </div>
     </div>
   </div>
 </main>
</div>
