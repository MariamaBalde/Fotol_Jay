<div class="liste-produits-container">
  <!-- Navigation -->
  <app-navbar></app-navbar>

  <!-- Hero Section pour la page produits -->
  <section class="products-hero">
    <div class="hero-overlay">
      <div class="hero-content">
        <h1 class="hero-title">🛍️ Découvrez tous nos produits</h1>
        <p class="hero-subtitle">Des milliers d'annonces vérifiées et transparentes</p>

        <!-- Barre de recherche améliorée -->
        <div class="search-section">
          <div class="search-bar">
            <input
              type="text"
              [(ngModel)]="rechercheTexte"
              (keyup.enter)="rechercher()"
              placeholder="Rechercher un produit, une marque..."
              class="search-input"
            />
            <button class="search-button" (click)="rechercher()">
              <span class="search-icon">🔍</span>
              <span class="search-text">Rechercher</span>
            </button>
          </div>
        </div>
      </div>
    </div>
  </section>

 <!-- Filtres avancés -->
 <section class="filters-section">
   <div class="filters-container">
     <!-- Barre de filtres principale -->
     <div class="filters-bar">
       <!-- Catégories -->
       <div class="filter-group">
         <label class="filter-label">🏷️ Catégorie</label>
         <select
           class="filter-select"
           [ngModel]="filtres.categorie || 'Tous'"
           (ngModelChange)="filtrerParCategorie($event)"
         >
           <option value="Tous">Toutes les catégories</option>
           <option *ngFor="let categorie of categories.slice(1)" [value]="categorie">
             {{ categorie }}
           </option>
         </select>
       </div>

       <!-- États -->
       <div class="filter-group">
         <label class="filter-label">📦 État</label>
         <select
           class="filter-select"
           [ngModel]="filtres.etat || 'Tous'"
           (ngModelChange)="filtrerParEtat($event)"
         >
           <option value="Tous">Tous les états</option>
           <option *ngFor="let etat of etats.slice(1)" [value]="etat">
             {{ etat.replace('_', ' ') }}
           </option>
         </select>
       </div>

       <!-- Prix -->
       <div class="filter-group">
         <label class="filter-label">💰 Prix (FCFA)</label>
         <div class="price-range">
           <input
             type="number"
             placeholder="Min"
             class="price-input"
             [(ngModel)]="filtres.prixMin"
             (input)="appliquerPrixMin()"
           />
           <span class="price-separator">-</span>
           <input
             type="number"
             placeholder="Max"
             class="price-input"
             [(ngModel)]="filtres.prixMax"
             (input)="appliquerPrixMax()"
           />
         </div>
       </div>

       <!-- Bouton réinitialiser -->
       <button class="btn-reset-filters" (click)="reinitialiserFiltres()">
         🔄 Réinitialiser
       </button>
     </div>
   </div>
 </section>

 <!-- Résultats et contenu principal -->
 <main class="main-content">
   <!-- Compteur de résultats -->
   <div class="results-header" *ngIf="!chargement">
     <div class="results-info">
       <h2 class="results-title">
         <span class="results-count">{{ totalProduits }}</span> produit(s) trouvé(s)
         <span class="results-query" *ngIf="filtres.recherche">pour "{{ filtres.recherche }}"</span>
       </h2>
       <div class="results-sort">
         <select class="sort-select" (change)="trierProduits($event)">
           <option value="recent">Plus récents</option>
           <option value="prix-asc">Prix croissant</option>
           <option value="prix-desc">Prix décroissant</option>
           <option value="vues">Plus populaires</option>
         </select>
       </div>
     </div>
   </div>

   <!-- Loading -->
   <div *ngIf="chargement" class="loading-section">
     <app-loading-spinner [taille]="'large'" [message]="'Découverte des meilleurs produits...'">
     </app-loading-spinner>
   </div>

   <!-- Message d'erreur -->
   <div *ngIf="erreur && !chargement" class="error-section">
     <div class="error-card">
       <span class="error-icon">⚠️</span>
       <h3>Oups ! Une erreur est survenue</h3>
       <p>{{ erreur }}</p>
       <button class="btn-retry" (click)="chargerProduits()">Réessayer</button>
     </div>
   </div>

   <!-- Grille de produits -->
   <div *ngIf="!chargement && !erreur" class="products-section">
     <div class="products-grid">
       <app-product-card *ngFor="let produit of produits" [produit]="produit">
       </app-product-card>
     </div>
   </div>

   <!-- État vide -->
   <div *ngIf="!chargement && !erreur && produits.length === 0" class="empty-state">
     <div class="empty-card">
       <div class="empty-icon">🔍</div>
       <h3>Aucun produit trouvé</h3>
       <p>Nous n'avons trouvé aucun produit correspondant à vos critères.</p>
       <p>Essayez de modifier vos filtres ou votre recherche.</p>
       <button class="btn-reset" (click)="reinitialiserFiltres()">
         <span class="btn-icon">🔄</span>
         Réinitialiser les filtres
       </button>
     </div>
   </div>

   <!-- Pagination améliorée -->
   <div *ngIf="totalPages > 1 && !chargement" class="pagination-section">
     <div class="pagination-container">
       <button
         class="pagination-btn prev"
         [disabled]="pageActuelle === 1"
         (click)="changerPage(pageActuelle - 1)"
       >
         <span class="btn-icon">←</span>
         Précédent
       </button>

       <div class="pagination-numbers">
         <button
           *ngFor="let page of obtenirTableauPages()"
           class="pagination-btn number"
           [class.active]="page === pageActuelle"
           (click)="changerPage(page)"
         >
           {{ page }}
         </button>
       </div>

       <button
         class="pagination-btn next"
         [disabled]="pageActuelle === totalPages"
         (click)="changerPage(pageActuelle + 1)"
       >
         Suivant
         <span class="btn-icon">→</span>
       </button>
     </div>

     <div class="pagination-info">
       Page {{ pageActuelle }} sur {{ totalPages }}
     </div>
   </div>
 </main>
</div>